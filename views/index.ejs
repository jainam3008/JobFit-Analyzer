<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>JobFit Analyzer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  </head>
  <body class="bg-dark text-white">
    <header class="bg-gradient sticky-top py-3">
      <div class="container text-center">
        <h1 class="display-5 fw-bold mb-0"><span class="me-2">üìä</span> JobFit Analyzer</h1>
        <p class="lead">Empowering Smart Hiring with AI Precision</p>
      </div>
    </header>
    <div class="container py-5">
      <div class="card shadow-lg border-0 bg-transparent">
        <div class="card-body">
          <form action="/upload" method="post" enctype="multipart/form-data" id="uploadForm" class="needs-validation" novalidate>
            <div class="mb-4">
              <label class="custom-file-upload">
                <input type="file" name="resume" id="resumeInput" accept=".pdf,.docx" class="form-control" required />
                <span class="file-label">Upload Resume (.pdf or .docx)</span>
                <span class="file-info">Drag and drop or click to upload</span>
              </label>
              <div class="file-preview mt-2" id="filePreview">
                <button type="button" class="btn btn-outline-light btn-sm view-details" data-target="resume">View Details</button>
                <div class="preview-content collapse" id="resumePreviewContent"></div>
              </div>
            </div>
            <div class="mb-4">
              <label class="custom-file-upload">
                <input type="file" name="jobDescription" id="jdInput" accept=".pdf,.docx" class="form-control" required />
                <span class="file-label">Upload Job Description (.pdf or .docx)</span>
                <span class="file-info">Drag and drop or click to upload</span>
              </label>
              <div class="file-preview mt-2" id="jdPreview">
                <button type="button" class="btn btn-outline-light btn-sm view-details" data-target="jd">View Details</button>
                <div class="preview-content collapse" id="jdPreviewContent"></div>
              </div>
            </div>
            <button type="submit" class="btn btn-neon w-100 py-2 mb-4">Analyze Match</button>
          </form>

          <% let resultObj = { score: 0, strengths: [], weaknesses: [], final_verdict: "", candidate_type: "Web Developer", training_suggestions: {
          languages: [], reason: "" } }; if (typeof result !== 'undefined') { try { resultObj = JSON.parse(result); } catch (e) {
          resultObj.training_suggestions.reason = result; } } %>

          <div class="card result-card mt-5 animate__animated animate__fadeIn">
            <div class="card-body">
              <div class="analysis-header mb-4">
                <h1 class="analysis-title">Resume Matching Insights</h1>
                <p class="analysis-subtitle">An AI-powered evaluation of how well the resume aligns with the job description</p>
              </div>

              <div class="score-section mb-4 text-center">
                <h2 class="text-info-neon mb-2">Resume Match Score: <%= resultObj.score || 0 %>/10</h2>

                <p class="text-muted-neon mb-2">How well the resume matches the job description</p>

                <div class="score-circle-wrapper">
                  <svg class="score-circle" viewBox="0 0 100 100">
                    <defs>
                      <linearGradient id="neonGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" stop-color="#6ee7b7" />
                        <stop offset="100%" stop-color="#34d399" />
                      </linearGradient>
                    </defs>
                    <circle class="bg" cx="50" cy="50" r="45" />
                    <circle
                      class="progress"
                      cx="50"
                      cy="50"
                      r="45"
                      stroke-dasharray="282.6"
                      stroke-dashoffset="<%= 282.6 - (resultObj.score || 0) * 28.26 %>"
                    />
                    <text x="50" y="55" text-anchor="middle" class="score-text"><%= resultObj.score || 0 %>/10</text>
                  </svg>
                  <p class="text-muted-neon mt-2">Resume Match Score</p>
                </div>

                <p class="mt-3 profile-snapshot">
                  <span class="badge bg-info-neon text-white"> Profile Snapshot: <%= resultObj.candidate_type %> </span>
                </p>
              </div>

              <div class="strengths-weaknesses mb-4 p-3 bg-dark-neon rounded">
                <h5 class="text-success-neon mb-3"><span class="me-2">‚úÖ</span> Strengths</h5>
                <ul class="list-group list-group-flush">
                  <% resultObj.strengths.forEach(strength => { %>
                  <li class="list-group-item bg-transparent text-white d-flex align-items-center"><span class="me-2">‚úì</span> <%= strength %></li>
                  <% }); %>
                </ul>
              </div>
              <div class="strengths-weaknesses mb-4 p-3 bg-dark-neon rounded">
                <h5 class="text-danger-neon mb-3"><span class="me-2">‚ùå</span> Weaknesses</h5>
                <ul class="list-group list-group-flush">
                  <% resultObj.weaknesses.forEach(weakness => { %>
                  <li class="list-group-item bg-transparent text-white d-flex align-items-center"><span class="me-2">‚úó</span> <%= weakness %></li>
                  <% }); %>
                </ul>
              </div>
              <div class="hiring-path mb-4 p-2 rounded-neon">
                <h5 class="text-center text-white">Hiring Recommendation: <%= resultObj.final_verdict %></h5>
              </div>
              <% if (resultObj.training_suggestions && resultObj.final_verdict === "Train & Hire") { %>
              <div class="skill-boost-card mb-4 p-4 rounded-neon">
                <div class="d-flex align-items-center mb-3">
                  <span class="skill-icon me-3">üéì</span>
                  <h4 class="skill-title m-0">Skill Boost Plan</h4>
                </div>
                <div class="skill-content">
                  <p>
                    <strong class="text-info-neon">Languages to Master:</strong>
                    <span class="text-white"><%= resultObj.training_suggestions.languages.join(", ") || "JavaScript, Node.js" %></span>
                  </p>
                  <p>
                    <strong class="text-info-neon">Why:</strong>
                    <span class="text-muted-neon"
                      ><%= resultObj.training_suggestions.reason || "To bridge skill gaps and align with job requirements" %></span
                    >
                  </p>
                </div>
              </div>
              <p class="text-muted-neon insight-text">
                üí° Insight: The score reflects alignment with the job based on skills, experience, and education. The path is AI-optimized.
              </p>
            </div>
          </div>
          <% } %>
        </div>
      </div>
    </div>

    <script src="/js/script.js"></script>
  </body>
</html>
